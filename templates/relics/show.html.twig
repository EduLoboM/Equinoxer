{% extends 'base.html.twig' %}
{% block title %}{{ relic.name }}{% endblock %}
{% block body %}
  <h1>
    {{ relic.name }}
  </h1>
  {% set chances = [] %}
  {% for reward in relic.rewards %}
    {% if reward.chance not in chances %}
      {% set chances = chances | merge([ reward.chance ]) %}
    {% endif %}
  {% endfor %}
  {# Agora ordena esse array de números #}
  {% set chances = chances | sort %}
  <ul>
    {% for chance in chances %}
      {% set items = [] %}
      {% for reward in relic.rewards %}
        {% if reward.chance == chance %}
          {% set items = items | merge([ reward ]) %}
        {% endif %}
      {% endfor %}
      <li>
        <strong>{{ chance }} %</strong> ({{ items|length }})
        <ul>
          {% for it in items %}
            <li>{{ it.item }}</li>
          {% endfor %}
        </ul>
      </li>
    {% endfor %}
  </ul>

  <h3>Missões onde encontrar a reliquia:</h3>
  {% if rewards is empty %}
    <div class="alert alert-info">
      <p>Nenhuma missão disponível para esta relíquia no momento.</p>
    </div>
  {% else %}
    <table class="table">
        <thead>
            <tr>
                <th>Planeta</th>
                <th>Missão</th>
                <th>Modo</th>
                <th>Rotação</th>
                <th>Chance</th>
            </tr>
        </thead>
        <tbody>
            {% for reward in rewards %}
                <tr>
                    <td>{{ reward.planet }}</td>
                    <td>{{ reward.mission }}</td>
                    <td>{{ reward.gameMode }}</td>
                    <td>{{ reward.rotation }}</td>
                    <td>{{ reward.chance }}%</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
  {% endif %}
{% endblock %}
